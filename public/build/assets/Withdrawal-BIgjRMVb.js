import{j as z,r as M,c as S,a as k,o as u,w as F,b as t,d as i,u as r,l as B,g,m as w,v as y,t as a,f as v,e as x,F as N,h as P,n as W,i as b}from"./app-BDRYJjhc.js";import{M as V,D as $,X as T,W as O,_ as X}from"./DashboardLayout-Bab0d4P_.js";import{n as d}from"./toastr-D4GJklOd.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as U}from"./phone-DsswXnSC.js";import{L as H}from"./loader-circle-DXATza37.js";import{C as f}from"./circle-check-big-C322FsJp.js";import{R as G}from"./refresh-cw-4a1snw_y.js";import{E as Q}from"./eye-CSMCi45H.js";import"./createLucideIcon-BNh8b1PT.js";import"./menu-B05H3Pe5.js";const J={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 backdrop-blur-sm text-white px-4 lg:px-8 py-3 flex items-center space-x-2 text-sm border-b border-purple-500/20"},Y={class:"p-4 lg:p-8"},Z={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},tt={class:"lg:col-span-2 bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6 shadow-2xl shadow-purple-500/20"},et={class:"relative"},st={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},lt={class:"relative"},rt={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ot=["min","max","placeholder"],at={class:"text-xs text-purple-400 mt-1"},nt={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-4 border border-purple-500/30"},it={class:"flex justify-between items-center"},dt={class:"text-2xl font-bold text-white"},pt={class:"text-right"},ut={class:"text-2xl font-bold text-white"},ct={class:"text-purple-400 text-xs mt-1"},mt=["disabled"],xt={class:"space-y-6"},bt={class:"bg-gradient-to-br from-green-600/40 to-emerald-600/40 backdrop-blur-xl border border-green-500/30 rounded-2xl p-6 shadow-2xl shadow-green-500/20"},ft={class:"space-y-4"},ht={class:"flex justify-between items-center"},gt={class:"text-white font-bold"},wt={class:"flex justify-between items-center"},yt={class:"text-white font-bold"},vt={class:"flex justify-between items-center"},_t={class:"text-yellow-400 font-bold"},St={class:"flex justify-between items-center"},kt={class:"text-green-400 font-bold"},Wt={class:"bg-gradient-to-br from-blue-600/40 to-cyan-600/40 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-6 shadow-2xl shadow-blue-500/20"},Ct={class:"space-y-2 text-sm"},Et={class:"flex items-start space-x-2"},At={class:"text-blue-100"},Lt={class:"flex items-start space-x-2"},qt={class:"text-blue-100"},Kt={class:"flex items-start space-x-2"},Rt={class:"flex items-start space-x-2"},jt={class:"bg-gradient-to-br from-purple-600/40 to-pink-600/40 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6 shadow-2xl shadow-purple-500/20"},Dt={class:"space-y-3"},zt={class:"mt-8 bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6 shadow-2xl shadow-purple-500/20"},Mt={class:"flex justify-between items-center mb-6"},Ft={class:"flex space-x-3"},Bt={class:"overflow-x-auto"},Nt={class:"w-full"},Pt={class:"py-3 px-4 text-white font-mono"},Vt={class:"py-3 px-4"},$t={class:"text-green-400 font-bold"},Tt={class:"py-3 px-4 text-purple-300"},Ot={class:"py-3 px-4 text-purple-300 text-sm font-mono"},Xt={class:"py-3 px-4 text-purple-300 text-sm"},It={class:"py-3 px-4"},Ut={class:"py-3 px-4"},Ht=["onClick"],Gt=["onClick"],Qt={key:0,class:"text-center py-8"},Jt={__name:"Withdrawal",props:{withdrawals:Array,stats:Object,limits:Object},setup(n){const c=n,o=z({whatsapp_number:"",amount:"",notes:""}),m=M(!1),_=S(()=>o.whatsapp_number&&o.amount>=c.limits.min&&o.amount<=c.limits.max&&o.amount<=c.stats.available_balance),C=S(()=>c.stats.available_balance-(o.amount||0)),h=l=>{o.amount=Math.min(l,c.stats.available_balance)},E=async()=>{if(_.value){m.value=!0;try{const l=new FormData;l.append("whatsapp_number",o.whatsapp_number),l.append("amount",o.amount),o.notes&&l.append("notes",o.notes);const e=await fetch("/cash-flow/whatsapp-withdrawals",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:l}),s=await e.json();if(e.ok)A(),b.reload({only:["withdrawals","stats"]}),d&&d.success(s.message||"Withdrawal request submitted successfully! It will be processed soon.","Success!");else{let p=s.message||"Error submitting withdrawal request. Please check the form and try again.";throw s.errors&&(s.errors.amount?p=s.errors.amount:s.errors.whatsapp_number?p=s.errors.whatsapp_number:s.errors.general&&(p=s.errors.general)),new Error(p)}}catch(l){console.error("Error submitting withdrawal:",l),d&&d.error(l.message,"Error!")}finally{m.value=!1}}},A=()=>{o.reset()},L=()=>{b.reload({only:["withdrawals","stats"]}),d&&d.info("Withdrawals list has been refreshed.","Refreshed!")},q=l=>{b.visit(route("cash-flow.whatsapp-withdrawals.show",l.id))},K=async l=>{if(confirm("Are you sure you want to cancel this withdrawal request?"))try{const e=await fetch(`/cash-flow/whatsapp-withdrawals/${l.id}/cancel`,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}),s=await e.json();if(e.ok)b.reload({only:["withdrawals","stats"]}),d&&d.success(s.message,"Cancelled!");else throw new Error(s.message)}catch(e){console.error("Error cancelling withdrawal:",e),d&&d.error(e.message,"Error!")}},R=l=>({pending:"bg-yellow-500/20 text-yellow-300",approved:"bg-blue-500/20 text-blue-300",processing:"bg-purple-500/20 text-purple-300",completed:"bg-green-500/20 text-green-300",rejected:"bg-red-500/20 text-red-300",failed:"bg-red-500/20 text-red-300"})[l.toLowerCase()]||"bg-gray-500/20 text-gray-300",j=l=>({pending:"bg-yellow-400",approved:"bg-blue-400",processing:"bg-purple-400",completed:"bg-green-400",rejected:"bg-red-400",failed:"bg-red-400"})[l.toLowerCase()]||"bg-gray-400",D=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(l,e)=>(u(),k(X,{title:"WhatsApp Withdrawals"},{default:F(()=>[t("div",J,[i(r(V),{size:16,class:"text-purple-400"}),e[6]||(e[6]=t("span",null,"Cash Flow",-1)),e[7]||(e[7]=t("span",{class:"text-purple-400"},"â€º",-1)),e[8]||(e[8]=t("span",{class:"text-purple-300"},"WhatsApp Withdrawals",-1))]),t("div",Y,[t("div",Z,[t("div",tt,[e[15]||(e[15]=t("h2",{class:"text-2xl font-bold text-white mb-2"},"Request WhatsApp Withdrawal",-1)),e[16]||(e[16]=t("p",{class:"text-purple-300 mb-6"},"Withdraw your earnings to your WhatsApp number",-1)),t("form",{onSubmit:B(E,["prevent"]),class:"space-y-6"},[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-purple-300 text-sm font-medium mb-2"},[g(" WhatsApp Number "),t("span",{class:"text-red-400"},"*")],-1)),t("div",et,[t("div",st,[i(r(U),{size:20,class:"text-purple-400"})]),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(o).whatsapp_number=s),type:"tel",required:"",placeholder:"254712345678",class:"w-full bg-slate-800/50 border border-purple-500/30 rounded-xl pl-10 pr-4 py-3 text-white placeholder-purple-400/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"},null,512),[[y,r(o).whatsapp_number]])]),e[10]||(e[10]=t("p",{class:"text-xs text-purple-400 mt-1"},"Format: 254712345678 (without +)",-1))]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-purple-300 text-sm font-medium mb-2"},[g(" Amount (KES) "),t("span",{class:"text-red-400"},"*")],-1)),t("div",lt,[t("div",rt,[i(r($),{size:20,class:"text-purple-400"})]),w(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(o).amount=s),type:"number",min:n.limits.min,max:n.limits.max,required:"",placeholder:`Enter amount (KES ${n.limits.min} - ${n.limits.max})`,class:"w-full bg-slate-800/50 border border-purple-500/30 rounded-xl pl-10 pr-4 py-3 text-white placeholder-purple-400/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"},null,8,ot),[[y,r(o).amount,void 0,{number:!0}]])]),t("p",at," Minimum: KES "+a(n.limits.min.toLocaleString())+" | Maximum: KES "+a(n.limits.max.toLocaleString()),1)]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-purple-300 text-sm font-medium mb-2"}," Notes (Optional) ",-1)),w(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(o).notes=s),rows:"3",placeholder:"Any additional information...",class:"w-full bg-slate-800/50 border border-purple-500/30 rounded-xl px-4 py-3 text-white placeholder-purple-400/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"},null,512),[[y,r(o).notes]])]),t("div",nt,[t("div",it,[t("div",null,[e[13]||(e[13]=t("p",{class:"text-purple-300 text-sm"},"Available Balance",-1)),t("p",dt," KES "+a(n.stats.available_balance.toLocaleString()),1)]),t("div",pt,[e[14]||(e[14]=t("p",{class:"text-purple-300 text-sm"},"Requested Amount",-1)),t("p",ut," KES "+a((r(o).amount||0).toLocaleString()),1),t("p",ct," Remaining: KES "+a(C.value.toLocaleString()),1)])])]),t("button",{type:"submit",disabled:!_.value||m.value,class:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed text-white font-medium py-4 rounded-xl transition-all duration-200 shadow-lg shadow-purple-500/50 flex items-center justify-center space-x-2"},[m.value?(u(),k(r(H),{key:0,size:20,class:"animate-spin"})):v("",!0),t("span",null,a(m.value?"Processing...":"Request Withdrawal"),1)],8,mt)],32)]),t("div",xt,[t("div",bt,[e[21]||(e[21]=t("h3",{class:"text-lg font-bold text-white mb-4"},"Withdrawal Stats",-1)),t("div",ft,[t("div",ht,[e[17]||(e[17]=t("span",{class:"text-green-200"},"Total Withdrawn",-1)),t("span",gt,"KES "+a(n.stats.total_withdrawn.toLocaleString()),1)]),t("div",wt,[e[18]||(e[18]=t("span",{class:"text-green-200"},"Available Balance",-1)),t("span",yt,"KES "+a(n.stats.available_balance.toLocaleString()),1)]),t("div",vt,[e[19]||(e[19]=t("span",{class:"text-green-200"},"Pending",-1)),t("span",_t,a(n.stats.pending_withdrawals),1)]),t("div",St,[e[20]||(e[20]=t("span",{class:"text-green-200"},"Completed",-1)),t("span",kt,a(n.stats.completed_withdrawals),1)])])]),t("div",Wt,[e[24]||(e[24]=t("h3",{class:"text-lg font-bold text-white mb-4"},"Withdrawal Guidelines",-1)),t("ul",Ct,[t("li",Et,[i(r(f),{size:16,class:"text-green-400 mt-0.5 flex-shrink-0"}),t("span",At,"Minimum withdrawal: KES "+a(n.limits.min.toLocaleString()),1)]),t("li",Lt,[i(r(f),{size:16,class:"text-green-400 mt-0.5 flex-shrink-0"}),t("span",qt,"Maximum withdrawal: KES "+a(n.limits.max.toLocaleString()),1)]),t("li",Kt,[i(r(f),{size:16,class:"text-green-400 mt-0.5 flex-shrink-0"}),e[22]||(e[22]=t("span",{class:"text-blue-100"},"Processing time: 2-24 hours",-1))]),t("li",Rt,[i(r(f),{size:16,class:"text-green-400 mt-0.5 flex-shrink-0"}),e[23]||(e[23]=t("span",{class:"text-blue-100"},"WhatsApp number must be active",-1))])])]),t("div",jt,[e[25]||(e[25]=t("h3",{class:"text-lg font-bold text-white mb-4"},"Quick Actions",-1)),t("div",Dt,[t("button",{onClick:e[3]||(e[3]=s=>h(n.stats.available_balance)),class:"w-full bg-purple-500/30 hover:bg-purple-500/50 p-3 rounded-xl text-white text-sm transition-all duration-200 text-center"}," Withdraw Full Balance "),t("button",{onClick:e[4]||(e[4]=s=>h(1e3)),class:"w-full bg-purple-500/30 hover:bg-purple-500/50 p-3 rounded-xl text-white text-sm transition-all duration-200 text-center"}," Withdraw KES 1,000 "),t("button",{onClick:e[5]||(e[5]=s=>h(5e3)),class:"w-full bg-purple-500/30 hover:bg-purple-500/50 p-3 rounded-xl text-white text-sm transition-all duration-200 text-center"}," Withdraw KES 5,000 ")])])])]),t("div",zt,[t("div",Mt,[e[27]||(e[27]=t("h3",{class:"text-xl font-bold text-white"},"Recent Withdrawals",-1)),t("div",Ft,[t("button",{onClick:L,class:"bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded-xl text-white text-sm transition-all duration-200 flex items-center space-x-2"},[i(r(G),{size:16}),e[26]||(e[26]=t("span",null,"Refresh",-1))])])]),t("div",Bt,[t("table",Nt,[e[28]||(e[28]=t("thead",null,[t("tr",{class:"border-b border-purple-500/30"},[t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"ID"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Amount"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Phone"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Transaction ID"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Date"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Status"),t("th",{class:"text-left py-3 px-4 text-purple-300 font-medium"},"Actions")])],-1)),t("tbody",null,[(u(!0),x(N,null,P(n.withdrawals,s=>(u(),x("tr",{key:s.id,class:"border-b border-purple-500/10 hover:bg-purple-500/5 transition-colors"},[t("td",Pt,"#"+a(s.id.toString().padStart(6,"0")),1),t("td",Vt,[t("span",$t,"KES "+a(s.amount.toLocaleString()),1)]),t("td",Tt,a(s.whatsapp_number),1),t("td",Ot,a(s.transaction_id),1),t("td",Xt,a(D(s.requested_at)),1),t("td",It,[t("span",{class:W(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",R(s.status)])},[t("span",{class:W(["w-2 h-2 rounded-full mr-1.5",j(s.status)])},null,2),g(" "+a(s.status),1)],2)]),t("td",Ut,[t("button",{onClick:p=>q(s),class:"text-purple-400 hover:text-purple-300 transition-colors p-1",title:"View Details"},[i(r(Q),{size:16})],8,Ht),s.status==="pending"?(u(),x("button",{key:0,onClick:p=>K(s),class:"text-red-400 hover:text-red-300 transition-colors p-1 ml-2",title:"Cancel Withdrawal"},[i(r(T),{size:16})],8,Gt)):v("",!0)])]))),128))])]),n.withdrawals.length===0?(u(),x("div",Qt,[i(r(O),{size:48,class:"mx-auto text-purple-400 mb-4"}),e[29]||(e[29]=t("p",{class:"text-purple-300 text-lg"},"No withdrawal requests yet",-1)),e[30]||(e[30]=t("p",{class:"text-purple-400"},"Start by requesting your first withdrawal above",-1))])):v("",!0)])])])]),_:1}))}},de=I(Jt,[["__scopeId","data-v-4ca1f4a7"]]);export{de as default};
