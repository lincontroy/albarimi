import{r as p,y as E,G as L,a as h,o as n,w as O,b as e,d as l,u as r,e as i,f as v,D as T,t as c,m as W,v as S,l as V,i as y}from"./app-B44wr4c_.js";import{M as k,X,_ as R}from"./DashboardLayout-C2D5VWEJ.js";import{C as b}from"./circle-check-big-D6jT3KiE.js";import{E as q}from"./external-link-BgPeaHHK.js";import{c as F}from"./createLucideIcon-CNz6d2hL.js";import{L as I}from"./loader-circle-JNCLJVDx.js";import{L as B}from"./link-Ci92WBYo.js";import{S as M}from"./shield-B3JqxWYs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./eye-By03grgf.js";import"./menu-BwH3VRfh.js";/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=F("unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),$={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 backdrop-blur-sm text-white px-4 lg:px-8 py-3 flex items-center space-x-2 text-sm border-b border-green-500/20"},D={class:"p-4 lg:p-8"},U={class:"max-w-4xl mx-auto"},K={key:0,class:"mb-8"},G={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-6 shadow-2xl shadow-blue-500/20"},J={class:"flex items-center justify-between mb-6"},Q={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},H={class:"flex items-center space-x-3 mb-4"},Z={class:"w-12 h-12 bg-green-600/20 rounded-full flex items-center justify-center"},ee={class:"text-2xl font-bold text-white"},te={class:"text-sm text-green-300"},se={key:0,class:"p-3 bg-green-500/10 border border-green-500/30 rounded-lg"},oe={class:"flex items-center space-x-2"},re={class:"text-green-300"},ne={class:"space-y-3"},le=["href"],ae={class:"flex items-center space-x-3"},ie={class:"flex items-center space-x-3"},de={key:0,class:"mt-6 pt-6 border-t border-blue-500/20"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue={class:"relative"},pe={class:"text-center mt-2"},fe=["disabled"],me={key:0},be={key:1},xe={class:"flex flex-col items-center justify-center"},ge=["disabled"],he={key:0},ve={key:1},ye={key:0,class:"text-sm text-yellow-400"},ke={key:1,class:"mb-8"},we={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-green-500/30 rounded-2xl p-6 shadow-2xl shadow-green-500/20"},Ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},_e={class:"mb-4"},We={class:"relative"},Se=["disabled"],Ce={class:"space-y-2"},je={class:"flex items-start space-x-2 text-sm text-green-200"},Ne={class:"flex items-start space-x-2 text-sm text-green-200"},ze={class:"flex items-start space-x-2 text-sm text-green-200"},Pe={class:"flex items-start space-x-2 text-sm text-green-200"},Ee={class:"mt-8 bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-6 shadow-2xl shadow-blue-500/20"},Le={class:"flex items-start space-x-3"},$e={__name:"Index",props:{linkage:{type:Object,default:null},cooldown:{type:Number,default:0},user:{type:Object,default:()=>({})}},setup(o){const w=o,f=p(""),u=p(""),m=p(!1),x=p(!1),A=p(!1),d=p(w.cooldown);E(()=>{d.value>0&&g()}),L(()=>w.cooldown,s=>{d.value=s,s>0&&g()});const g=()=>{const s=setInterval(()=>{d.value>0?d.value--:clearInterval(s)},1e3)},_=s=>{const t=Math.floor(s/60),a=s%60;return`${t}:${a.toString().padStart(2,"0")}`},C=async()=>{if(!f.value){alert("Please enter your WhatsApp phone number");return}let s=f.value.replace(/\D/g,"");if(s.startsWith("0")&&(s=s.substring(1)),s.length!==9){alert("Please enter a valid 9-digit phone number (after 254)");return}m.value=!0;try{const a=await(await fetch("/whatsapp-linkage/link",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({phone_number:s})})).json();if(a.success)alert("WhatsApp number linked successfully! Verification code sent to your WhatsApp."),y.reload({preserveScroll:!0});else if(a.errors){const P=Object.values(a.errors)[0];alert(P)}else alert(a.message||"Failed to link WhatsApp number")}catch(t){console.error("Link error:",t),alert("An error occurred. Please try again.")}finally{m.value=!1}},j=async()=>{if(u.value.length!==6){alert("Please enter a 6-digit verification code");return}x.value=!0;try{const t=await(await fetch("/whatsapp-linkage/verify",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({verification_code:u.value})})).json();t.success?(alert("WhatsApp number verified successfully!"),y.reload({preserveScroll:!0})):(alert(t.message||"Invalid verification code"),u.value="")}catch(s){console.error("Verify error:",s),alert("An error occurred. Please try again.")}finally{x.value=!1}},N=async()=>{if(d.value>0){alert(`Please wait ${_(d.value)} before requesting a new code`);return}A.value=!0;try{const t=await(await fetch("/whatsapp-linkage/resend-verification",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}})).json();t.success?(alert("New verification code sent!"),d.value=t.cooldown||120,g()):(alert(t.message||"Failed to send verification code"),t.cooldown&&(d.value=t.cooldown,g()))}catch(s){console.error("Resend error:",s),alert("An error occurred. Please try again.")}finally{A.value=!1}},z=async()=>{if(confirm("Are you sure you want to unlink your WhatsApp number? You will need to verify again to re-link."))try{const t=await(await fetch("/whatsapp-linkage/unlink",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({confirmation:!0})})).json();t.success?(alert("WhatsApp number unlinked successfully!"),y.reload({preserveScroll:!0})):alert(t.message||"Failed to unlink WhatsApp number")}catch(s){console.error("Unlink error:",s),alert("An error occurred. Please try again.")}};return(s,t)=>(n(),h(R,{title:"WhatsApp Linkage"},{default:O(()=>[e("div",$,[l(r(k),{size:16,class:"text-green-400"}),t[2]||(t[2]=e("span",null,"WhatsApp Linkage",-1)),t[3]||(t[3]=e("span",{class:"text-green-400"},"â€º",-1)),t[4]||(t[4]=e("span",{class:"text-green-300"},"Dashboard",-1))]),e("div",D,[e("div",U,[t[22]||(t[22]=e("div",{class:"mb-8"},[e("h1",{class:"text-2xl lg:text-3xl font-bold text-white mb-2"},"Link Your WhatsApp"),e("p",{class:"text-green-300"},"Connect your WhatsApp number for seamless communication")],-1)),o.linkage?(n(),i("div",K,[e("div",G,[e("div",J,[t[5]||(t[5]=e("h2",{class:"text-xl font-bold text-white"},"Current Status",-1)),e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",style:T(`background-color: ${o.linkage.status_badge.bgColor}; color: ${o.linkage.status_badge.color}`)},c(o.linkage.status_badge.text),5)]),e("div",Q,[e("div",null,[t[6]||(t[6]=e("h3",{class:"font-bold text-white mb-3"},"Linked WhatsApp Number",-1)),e("div",H,[e("div",Z,[l(r(k),{size:24,class:"text-green-400"})]),e("div",null,[e("div",ee,c(o.linkage.phone_number),1),e("div",te,"International: "+c(o.linkage.formatted_phone),1)])]),o.linkage.verified_at?(n(),i("div",se,[e("div",oe,[l(r(b),{size:16,class:"text-green-400"}),e("span",re,"Verified on "+c(o.linkage.verified_at),1)])])):v("",!0)]),e("div",null,[t[9]||(t[9]=e("h3",{class:"font-bold text-white mb-3"},"Quick Actions",-1)),e("div",ne,[e("a",{href:o.linkage.whatsapp_chat_link,target:"_blank",class:"flex items-center justify-between p-3 bg-green-600/20 border border-green-500/30 rounded-lg hover:bg-green-500/20 transition-all duration-200 group"},[e("div",ae,[l(r(k),{size:20,class:"text-green-400"}),t[7]||(t[7]=e("span",{class:"text-white group-hover:text-green-300"},"Open WhatsApp Chat",-1))]),l(r(q),{size:16,class:"text-green-400 group-hover:text-green-300"})],8,le),e("button",{onClick:z,class:"w-full flex items-center justify-between p-3 bg-red-600/20 border border-red-500/30 rounded-lg hover:bg-red-500/20 transition-all duration-200 group"},[e("div",ie,[l(r(Y),{size:20,class:"text-red-400"}),t[8]||(t[8]=e("span",{class:"text-white group-hover:text-red-300"},"Unlink WhatsApp",-1))]),l(r(X),{size:16,class:"text-red-400 group-hover:text-red-300"})])])])]),o.linkage.status==="pending"?(n(),i("div",de,[t[10]||(t[10]=e("h3",{class:"font-bold text-white mb-3"},"Verify Your Number",-1)),t[11]||(t[11]=e("p",{class:"text-blue-300 mb-4"}," We sent a 6-digit verification code to your WhatsApp number. Enter it below to complete verification. ",-1)),e("div",ce,[e("div",null,[e("div",ue,[W(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),type:"text",maxlength:"6",placeholder:"Enter 6-digit code",class:"w-full bg-black/30 border border-blue-500/30 text-white rounded-xl px-4 py-3 text-center text-2xl tracking-widest focus:outline-none focus:border-blue-400"},null,512),[[S,u.value]])]),e("div",pe,[e("button",{onClick:j,disabled:u.value.length!==6||x.value,class:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed text-white font-bold py-2 px-6 rounded-lg transition-all duration-200"},[x.value?(n(),i("span",me,"Verifying...")):(n(),i("span",be,"Verify Code"))],8,fe)])]),e("div",xe,[e("button",{onClick:N,disabled:o.cooldown>0||!o.linkage.can_send_verification,class:"text-green-400 hover:text-green-300 disabled:text-gray-500 disabled:cursor-not-allowed mb-2"},[o.cooldown>0?(n(),i("span",he,"Resend in "+c(_(o.cooldown)),1)):(n(),i("span",ve,"Resend Verification Code"))],8,ge),o.linkage.verification_attempts>0?(n(),i("div",ye,c(o.linkage.verification_attempts)+" verification attempts ",1)):v("",!0)])])])):v("",!0)])])):(n(),i("div",ke,[e("div",we,[t[20]||(t[20]=e("h2",{class:"text-xl font-bold text-white mb-6"},"Link Your WhatsApp Number",-1)),e("div",Ae,[e("div",null,[e("form",{onSubmit:V(C,["prevent"])},[e("div",_e,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-green-300 mb-2"}," WhatsApp Phone Number ",-1)),e("div",We,[t[12]||(t[12]=e("span",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-green-400"},"+254",-1)),W(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>f.value=a),type:"tel",required:"",class:"w-full bg-black/30 border border-green-500/30 text-white rounded-xl pl-20 pr-4 py-3 focus:outline-none focus:border-green-400",placeholder:"7XXXXXXXX",pattern:"[0-9]{9}",title:"Enter 9 digits after 254"},null,512),[[S,f.value]])]),t[14]||(t[14]=e("p",{class:"text-xs text-green-400 mt-1"},"Enter your phone number without the country code",-1))]),e("button",{type:"submit",disabled:m.value||!f.value,class:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2"},[m.value?(n(),h(r(I),{key:0,class:"animate-spin",size:20})):(n(),h(r(B),{key:1,size:20})),e("span",null,c(m.value?"Linking...":"Link WhatsApp"),1)],8,Se)],32)]),e("div",null,[t[19]||(t[19]=e("h3",{class:"font-bold text-white mb-3"},"Benefits of Linking",-1)),e("ul",Ce,[e("li",je,[l(r(b),{size:14,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[15]||(t[15]=e("span",null,"Receive instant notifications for job applications",-1))]),e("li",Ne,[l(r(b),{size:14,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[16]||(t[16]=e("span",null,"Get loan approval updates directly on WhatsApp",-1))]),e("li",ze,[l(r(b),{size:14,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[17]||(t[17]=e("span",null,"Quick customer support via WhatsApp",-1))]),e("li",Pe,[l(r(b),{size:14,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[18]||(t[18]=e("span",null,"Secure verification for transactions",-1))])])])])])])),t[23]||(t[23]=e("div",{class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-yellow-500/30 rounded-2xl p-6 shadow-2xl shadow-yellow-500/20"},[e("h3",{class:"text-lg font-bold text-white mb-4"},"How It Works"),e("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-6"},[e("div",{class:"text-center"},[e("div",{class:"inline-flex items-center justify-center w-12 h-12 bg-yellow-600/20 rounded-full mb-3"},[e("span",{class:"text-yellow-400 font-bold"},"1")]),e("h4",{class:"font-bold text-white mb-2"},"Enter Your Number"),e("p",{class:"text-sm text-yellow-300"},"Provide your WhatsApp phone number")]),e("div",{class:"text-center"},[e("div",{class:"inline-flex items-center justify-center w-12 h-12 bg-yellow-600/20 rounded-full mb-3"},[e("span",{class:"text-yellow-400 font-bold"},"2")]),e("h4",{class:"font-bold text-white mb-2"},"Receive Code"),e("p",{class:"text-sm text-yellow-300"},"Get 6-digit verification code on WhatsApp")]),e("div",{class:"text-center"},[e("div",{class:"inline-flex items-center justify-center w-12 h-12 bg-yellow-600/20 rounded-full mb-3"},[e("span",{class:"text-yellow-400 font-bold"},"3")]),e("h4",{class:"font-bold text-white mb-2"},"Verify & Enjoy"),e("p",{class:"text-sm text-yellow-300"},"Enter code to complete linking")])])],-1)),e("div",Ee,[e("div",Le,[l(r(M),{size:24,class:"text-blue-400 flex-shrink-0"}),t[21]||(t[21]=e("div",null,[e("h3",{class:"font-bold text-white mb-2"},"Security & Privacy"),e("p",{class:"text-blue-300"}," Your WhatsApp number is secure and will only be used for platform notifications and verification purposes. We never share your contact information with third parties. ")],-1))])])])])]),_:1}))}};export{$e as default};
