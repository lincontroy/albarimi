import{c as k,a as v,o as n,w as m,b as e,d as a,u as l,p as f,g as O,e as i,f as c,F as j,h as A,x as $,n as _,t as r,i as x}from"./app-KUgWEtTK.js";import{T as L,P as u,_ as U}from"./DashboardLayout-CBd3-9Qr.js";import{H as F}from"./history-DBkDGXGK.js";import{E as N}from"./eye-CqiVPK0H.js";import{R as D}from"./refresh-cw-HB3dmhw8.js";import{C as Y,a as q}from"./chevron-right-CzD1suH7.js";import{C as G}from"./crown-DXVGRvEg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-fdl4BT3X.js";import"./menu-hSB8Arlo.js";const J={class:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 backdrop-blur-sm text-white px-4 lg:px-8 py-3 flex items-center space-x-2 text-sm border-b border-green-500/20"},M={class:"p-4 lg:p-8"},Q={class:"max-w-7xl mx-auto"},W={class:"flex items-center justify-between mb-8"},X={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-green-500/30 rounded-2xl p-6 shadow-2xl shadow-green-500/20"},Z={class:"hidden lg:block overflow-x-auto"},ee={class:"w-full"},te={class:"py-4 px-4"},se={class:"flex items-center space-x-3"},oe={class:"text-white font-semibold"},re={class:"text-green-300 text-xs"},ne={class:"py-4 px-4"},ae={class:"text-white font-semibold"},le={class:"py-4 px-4"},ie={class:"text-white"},de={class:"py-4 px-4"},ce={key:0,class:"text-green-400 text-xs mt-1"},ge={key:1,class:"text-red-400 text-xs mt-1"},pe={class:"py-4 px-4"},xe={class:"text-white"},ue={class:"py-4 px-4"},be={class:"text-green-400 font-semibold"},me={class:"py-4 px-4"},fe={class:"flex items-center space-x-2"},_e=["onClick"],ye=["onClick"],he={class:"lg:hidden space-y-4"},ke={class:"flex items-center justify-between mb-3"},ve={class:"flex items-center space-x-3"},we={class:"text-white font-semibold"},Pe={class:"opacity-75 text-xs"},Ce={class:"space-y-2 text-sm"},Ee={class:"flex justify-between"},Se={class:"font-semibold"},ze={class:"flex justify-between"},je={class:"flex justify-between"},Ae={class:"flex justify-between"},$e={class:"font-semibold text-green-400"},Le={key:0,class:"flex justify-between text-green-400"},Ne={class:"font-semibold"},De={key:1,class:"flex justify-between text-red-400"},He={class:"flex items-center justify-between mt-4 pt-4 border-t border-white/10"},Re=["onClick"],Te=["onClick"],Ve={key:0,class:"text-center py-12"},Be={key:1,class:"flex items-center justify-between mt-6 pt-6 border-t border-green-500/20"},Ie={class:"text-green-300 text-sm"},Ke={class:"flex items-center space-x-2"},Oe=["disabled"],Ue={class:"text-white text-sm"},Fe=["disabled"],Ye={class:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-4"},qe={class:"bg-gradient-to-br from-green-600/40 to-emerald-600/40 backdrop-blur-xl border border-green-500/30 rounded-2xl p-4 shadow-2xl shadow-green-500/20"},Ge={class:"text-center"},Je={class:"text-2xl font-bold text-white"},Me={class:"bg-gradient-to-br from-blue-600/40 to-cyan-600/40 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-4 shadow-2xl shadow-blue-500/20"},Qe={class:"text-center"},We={class:"text-2xl font-bold text-white"},Xe={class:"bg-gradient-to-br from-yellow-600/40 to-amber-600/40 backdrop-blur-xl border border-yellow-500/30 rounded-2xl p-4 shadow-2xl shadow-yellow-500/20"},Ze={class:"text-center"},et={class:"text-2xl font-bold text-white"},tt={class:"bg-gradient-to-br from-orange-600/40 to-red-600/40 backdrop-blur-xl border border-orange-500/30 rounded-2xl p-4 shadow-2xl shadow-orange-500/20"},st={class:"text-center"},ot={class:"text-2xl font-bold text-white"},ut={__name:"History",props:{purchases:Object},setup(d){const g=d,H=k(()=>g.purchases.data.filter(o=>o.is_active).length),R=k(()=>g.purchases.data.filter(o=>o.is_active&&o.days_remaining<7).length),T=k(()=>g.purchases.data.reduce((o,t)=>o+(t.potential_earnings||0),0)),V=o=>({entry:"bg-gradient-to-br from-blue-600/40 to-cyan-600/40 border-blue-500/30",lite:"bg-gradient-to-br from-green-600/40 to-emerald-600/40 border-green-500/30",pro:"bg-gradient-to-br from-purple-600/40 to-pink-600/40 border-purple-500/30",bariplus:"bg-gradient-to-br from-orange-600/40 to-yellow-600/40 border-orange-500/30"})[o]||"bg-gradient-to-br from-slate-600/40 to-slate-700/40 border-slate-500/30",w=o=>({entry:u,lite:u,pro:u,bariplus:G})[o]||u,B=o=>({entry:"text-blue-400",lite:"text-green-400",pro:"text-purple-400",bariplus:"text-orange-400"})[o]||"text-slate-400",y=o=>o.replace(/\b\w/g,t=>t.toUpperCase()),P=o=>{switch(o){case"active":return"bg-green-500/20 text-green-400";case"pending":return"bg-yellow-500/20 text-yellow-400";case"expired":return"bg-red-500/20 text-red-400";case"cancelled":return"bg-gray-500/20 text-gray-400";default:return"bg-green-500/20 text-green-400"}},C=o=>{if(!o.is_active)return!1;const t=["entry","lite","pro","bariplus"];return t.indexOf(o.package_type)<t.length-1},E=async o=>{if(confirm("Are you sure you want to renew this package?"))try{await x.post(`/packages/${o}/renew`,{},{preserveScroll:!0,onSuccess:t=>{const s=t?.props?.flash||{};s.success&&(alert(s.success),x.reload())},onError:t=>{console.error("Error renewing package:",t),alert("Failed to renew package.")}})}catch(t){console.error("Error renewing package:",t),alert("An unexpected error occurred.")}},S=async o=>{const t=g.purchases.data.find(p=>p.id===o);if(!t)return;const s=["entry","lite","pro","bariplus"],b=s.indexOf(t.package_type),h=s[b+1];if(!h){alert("You are already on the highest package!");return}if(confirm(`Are you sure you want to upgrade to ${y(h)} package?`))try{await x.post(`/packages/${o}/upgrade`,{upgrade_to:h},{preserveScroll:!0,onSuccess:p=>{const z=p?.props?.flash||{};z.success&&(alert(z.success),x.reload())},onError:p=>{console.error("Error upgrading package:",p),alert("Failed to upgrade package.")}})}catch(p){console.error("Error upgrading package:",p),alert("An unexpected error occurred.")}},I=()=>{g.purchases.prev_page_url&&x.visit(g.purchases.prev_page_url)},K=()=>{g.purchases.next_page_url&&x.visit(g.purchases.next_page_url)};return(o,t)=>(n(),v(U,{title:"Packages - History"},{default:m(()=>[e("div",J,[a(l(F),{size:16,class:"text-green-400"}),t[0]||(t[0]=e("span",null,"Packages",-1)),t[1]||(t[1]=e("span",{class:"text-green-400"},"â€º",-1)),t[2]||(t[2]=e("span",{class:"text-green-300"},"Purchase History",-1))]),e("div",M,[e("div",Q,[e("div",W,[t[4]||(t[4]=e("h1",{class:"text-2xl font-bold text-white"},"Package Purchase History",-1)),a(l(f),{href:"/packages",class:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold py-2 px-4 rounded-xl transition-all duration-200 shadow-lg shadow-green-500/50"},{default:m(()=>t[3]||(t[3]=[O(" Back to Packages ")])),_:1})]),e("div",X,[e("div",Z,[e("table",ee,[t[5]||(t[5]=e("thead",null,[e("tr",{class:"border-b border-green-500/20"},[e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Package"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Amount"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Purchase Date"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Status"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Expires"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Earnings"),e("th",{class:"text-left py-3 px-4 text-green-300 text-sm font-semibold"},"Actions")])],-1)),e("tbody",null,[(n(!0),i(j,null,A(d.purchases.data,s=>(n(),i("tr",{key:s.id,class:"border-b border-green-500/10 hover:bg-green-500/5 transition-colors"},[e("td",te,[e("div",se,[(n(),v($(w(s.package_type)),{size:20,class:_(B(s.package_type))},null,8,["class"])),e("div",null,[e("p",oe,r(s.package_name),1),e("p",re,r(y(s.package_type)),1)])])]),e("td",ne,[e("p",ae,"KES "+r(s.amount.toLocaleString()),1)]),e("td",le,[e("p",ie,r(s.activated_at),1)]),e("td",de,[e("span",{class:_([P(s.status),"px-3 py-1 rounded-full text-xs font-semibold"])},r(s.status),3),s.is_active?(n(),i("p",ce,r(s.days_remaining)+" days remaining ",1)):c("",!0),s.is_expired?(n(),i("p",ge," Expired ")):c("",!0)]),e("td",pe,[e("p",xe,r(s.expires_at||"N/A"),1)]),e("td",ue,[e("p",be,"KES "+r(s.potential_earnings.toLocaleString()),1)]),e("td",me,[e("div",fe,[a(l(f),{href:"/packages/"+s.id,class:"text-blue-400 hover:text-blue-300 transition-colors p-2 hover:bg-blue-500/10 rounded-lg",title:"View Details"},{default:m(()=>[a(l(N),{size:16})]),_:2},1032,["href"]),s.is_active&&s.days_remaining<7?(n(),i("button",{key:0,onClick:b=>E(s.id),class:"text-green-400 hover:text-green-300 transition-colors p-2 hover:bg-green-500/10 rounded-lg",title:"Renew Package"},[a(l(D),{size:16})],8,_e)):c("",!0),C(s)?(n(),i("button",{key:1,onClick:b=>S(s.id),class:"text-purple-400 hover:text-purple-300 transition-colors p-2 hover:bg-purple-500/10 rounded-lg",title:"Upgrade Package"},[a(l(L),{size:16})],8,ye)):c("",!0)])])]))),128))])])]),e("div",he,[(n(!0),i(j,null,A(d.purchases.data,s=>(n(),i("div",{key:s.id,class:_([V(s.package_type),"border rounded-xl p-4"])},[e("div",ke,[e("div",ve,[(n(),v($(w(s.package_type)),{size:20})),e("div",null,[e("p",we,r(s.package_name),1),e("p",Pe,r(y(s.package_type)),1)])]),e("span",{class:_([P(s.status),"px-3 py-1 rounded-full text-xs font-semibold"])},r(s.status),3)]),e("div",Ce,[e("div",Ee,[t[6]||(t[6]=e("span",{class:"opacity-75"},"Amount:",-1)),e("span",Se,"KES "+r(s.amount.toLocaleString()),1)]),e("div",ze,[t[7]||(t[7]=e("span",{class:"opacity-75"},"Purchased:",-1)),e("span",null,r(s.activated_at),1)]),e("div",je,[t[8]||(t[8]=e("span",{class:"opacity-75"},"Expires:",-1)),e("span",null,r(s.expires_at||"N/A"),1)]),e("div",Ae,[t[9]||(t[9]=e("span",{class:"opacity-75"},"Earnings Potential:",-1)),e("span",$e,"KES "+r(s.potential_earnings.toLocaleString()),1)]),s.is_active?(n(),i("div",Le,[t[10]||(t[10]=e("span",null,"Days Remaining:",-1)),e("span",Ne,r(s.days_remaining)+" days",1)])):c("",!0),s.is_expired?(n(),i("div",De,t[11]||(t[11]=[e("span",null,"Status:",-1),e("span",{class:"font-semibold"},"Expired",-1)]))):c("",!0)]),e("div",He,[a(l(f),{href:"/packages/"+s.id,class:"text-blue-400 hover:text-blue-300 text-sm flex items-center space-x-1"},{default:m(()=>[a(l(N),{size:14}),t[12]||(t[12]=e("span",null,"Details",-1))]),_:2},1032,["href"]),s.is_active&&s.days_remaining<7?(n(),i("button",{key:0,onClick:b=>E(s.id),class:"text-green-400 hover:text-green-300 text-sm flex items-center space-x-1"},[a(l(D),{size:14}),t[13]||(t[13]=e("span",null,"Renew",-1))],8,Re)):c("",!0),C(s)?(n(),i("button",{key:1,onClick:b=>S(s.id),class:"text-purple-400 hover:text-purple-300 text-sm flex items-center space-x-1"},[a(l(L),{size:14}),t[14]||(t[14]=e("span",null,"Upgrade",-1))],8,Te)):c("",!0)])],2))),128))]),d.purchases.data.length===0?(n(),i("div",Ve,[a(l(u),{size:64,class:"mx-auto text-green-400 mb-4 opacity-50"}),t[16]||(t[16]=e("p",{class:"text-green-300 text-lg mb-2"},"No package purchases yet",-1)),t[17]||(t[17]=e("p",{class:"text-green-400 text-sm mb-6"},"Purchase your first earning package to get started",-1)),a(l(f),{href:"/packages",class:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg shadow-green-500/50 inline-flex items-center space-x-2"},{default:m(()=>[a(l(u),{size:18}),t[15]||(t[15]=e("span",null,"View Packages",-1))]),_:1})])):c("",!0),d.purchases.total>0?(n(),i("div",Be,[e("p",Ie," Showing "+r(d.purchases.from)+" to "+r(d.purchases.to)+" of "+r(d.purchases.total)+" purchases ",1),e("div",Ke,[e("button",{onClick:I,disabled:!d.purchases.prev_page_url,class:"bg-black/30 border border-green-500/30 text-white px-3 py-2 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed hover:border-green-500 transition-colors"},[a(l(Y),{size:16})],8,Oe),e("span",Ue," Page "+r(d.purchases.current_page)+" of "+r(d.purchases.last_page),1),e("button",{onClick:K,disabled:!d.purchases.next_page_url,class:"bg-black/30 border border-green-500/30 text-white px-3 py-2 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed hover:border-green-500 transition-colors"},[a(l(q),{size:16})],8,Fe)])])):c("",!0)]),e("div",Ye,[e("div",qe,[e("div",Ge,[t[18]||(t[18]=e("p",{class:"text-green-300 text-sm mb-1"},"Total Purchases",-1)),e("p",Je,r(d.purchases.total),1)])]),e("div",Me,[e("div",Qe,[t[19]||(t[19]=e("p",{class:"text-blue-300 text-sm mb-1"},"Active Packages",-1)),e("p",We,r(H.value),1)])]),e("div",Xe,[e("div",Ze,[t[20]||(t[20]=e("p",{class:"text-yellow-300 text-sm mb-1"},"Expiring Soon",-1)),e("p",et,r(R.value),1)])]),e("div",tt,[e("div",st,[t[21]||(t[21]=e("p",{class:"text-orange-300 text-sm mb-1"},"Total Earnings Potential",-1)),e("p",ot,"KES "+r(T.value.toLocaleString()),1)])])])])])]),_:1}))}};export{ut as default};
