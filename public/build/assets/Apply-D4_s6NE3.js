import{r as C,B as F,c as v,a as x,o as p,w as f,b as e,d as r,u as a,e as w,f as L,t as n,p as _,l as B,g as c,m as h,v as k,F as K,h as T,n as z,q as M,i as N}from"./app-KUgWEtTK.js";import{C as j,D as P,_ as V}from"./DashboardLayout-CBd3-9Qr.js";import{C as D}from"./circle-alert-zp-rkyuY.js";import{C as R}from"./circle-plus-B84xM5g1.js";import{C as I}from"./calendar-BjdAl2Eq.js";import{F as $}from"./file-text-CW7SMSPg.js";import{L as q}from"./loader-circle-COzy0sLb.js";import{F as U}from"./file-plus-CkYK5nfQ.js";import{C as b}from"./circle-check-big-C1-uGsP2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-fdl4BT3X.js";import"./eye-CqiVPK0H.js";import"./menu-hSB8Arlo.js";const Y={class:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 backdrop-blur-sm text-white px-4 lg:px-8 py-3 flex items-center space-x-2 text-sm border-b border-purple-500/20"},O={class:"p-4 lg:p-8"},W={class:"max-w-4xl mx-auto"},G={key:0,class:"mb-6 bg-gradient-to-br from-red-900/30 to-red-800/30 backdrop-blur-xl border border-red-500/30 rounded-2xl p-6 shadow-2xl shadow-red-500/20"},H={class:"flex items-center space-x-3 mb-3"},J={class:"text-red-300 mb-3"},Q={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},X={class:"lg:col-span-2"},Z={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6 shadow-2xl shadow-purple-500/20"},ee={class:"mb-6"},te={class:"block text-sm font-medium text-purple-300 mb-2"},se={class:"relative"},oe=["min","max","disabled"],le={class:"flex justify-between mt-2"},ae={class:"text-xs text-purple-400"},ne={class:"text-xs text-purple-400"},re={class:"mb-6"},ie={class:"block text-sm font-medium text-purple-300 mb-2"},de={class:"grid grid-cols-3 gap-2"},ue=["onClick"],me={class:"mb-6"},pe={class:"block text-sm font-medium text-purple-300 mb-2"},ce=["disabled"],be={class:"mb-6"},xe={class:"flex items-start space-x-2"},fe=["disabled"],he={for:"terms",class:"text-sm text-purple-300"},ge={class:"flex space-x-3"},ye=["disabled"],ve={class:"lg:col-span-1"},we={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-blue-500/30 rounded-2xl p-6 shadow-2xl shadow-blue-500/20 mb-6"},_e={class:"space-y-3"},ke={class:"flex justify-between items-center"},Ee={class:"font-bold text-white"},Se={class:"flex justify-between items-center"},Ae={class:"font-bold text-white"},Ce={class:"flex justify-between items-center"},Fe={class:"font-bold text-white"},Le={class:"flex justify-between items-center"},Be={class:"font-bold text-red-400"},Ke={class:"pt-3 border-t border-blue-500/20"},Te={class:"flex justify-between items-center mb-2"},ze={class:"font-bold text-green-400"},Me={class:"flex justify-between items-center"},Ne={class:"font-bold text-white"},je={class:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-green-500/30 rounded-2xl p-6 shadow-2xl shadow-green-500/20"},Pe={class:"space-y-2"},Ve={class:"flex items-start space-x-2 text-sm text-blue-200"},De={class:"flex items-start space-x-2 text-sm text-blue-200"},Re={class:"flex items-start space-x-2 text-sm text-blue-200"},Ie={class:"flex items-start space-x-2 text-sm text-blue-200"},tt={__name:"Apply",props:{applicationFee:{type:Number,default:200},hasEnoughBalance:{type:Boolean,default:!1},userBalance:{type:[Number,String],default:0},minAmount:{type:Number,default:1e3},maxAmount:{type:Number,default:5e4},defaultTerm:{type:Number,default:12},interestRate:{type:Number,default:5}},setup(o){const i=o,m=C(!1),E=[3,6,12,24,36],s=F({amount:1e4,term_months:i.defaultTerm,purpose:"",agreeTerms:!1}),g=v(()=>{const d=parseFloat(s.amount)||0,t=s.term_months,l=i.interestRate/100/12;if(l>0&&t>0){const y=d*(l*Math.pow(1+l,t))/(Math.pow(1+l,t)-1);return Math.round(y)}return 0}),S=v(()=>g.value*s.term_months),u=d=>(parseFloat(d)||0).toLocaleString("en-KE",{minimumFractionDigits:0,maximumFractionDigits:0}),A=async()=>{if(!i.hasEnoughBalance){alert("Insufficient balance for application fee");return}if(!s.agreeTerms){alert("You must agree to the terms and conditions");return}if(s.amount<i.minAmount||s.amount>i.maxAmount){alert(`Loan amount must be between KES ${i.minAmount.toLocaleString()} and KES ${i.maxAmount.toLocaleString()}`);return}if(confirm(`Are you sure you want to apply for a loan of KES ${u(s.amount)}? KES ${i.applicationFee} application fee will be deducted.`)){m.value=!0;try{await N.post("/loans/apply",s,{preserveScroll:!0,onSuccess:()=>{},onError:d=>{console.error("Loan application error:",d),alert("Failed to submit application. Please check the form and try again."),m.value=!1}})}catch(d){console.error("Loan application error:",d),alert("An unexpected error occurred. Please try again."),m.value=!1}}};return(d,t)=>(p(),x(V,{title:"Apply for Loan"},{default:f(()=>[e("div",Y,[r(a(j),{size:16,class:"text-purple-400"}),t[3]||(t[3]=e("span",null,"Loans",-1)),t[4]||(t[4]=e("span",{class:"text-purple-400"},"â€º",-1)),t[5]||(t[5]=e("span",{class:"text-purple-300"},"Apply for Loan",-1))]),e("div",O,[e("div",W,[t[26]||(t[26]=e("div",{class:"mb-8"},[e("h1",{class:"text-2xl lg:text-3xl font-bold text-white mb-2"},"Apply for Loan"),e("p",{class:"text-purple-300"},"Fill in the details below to apply for a quick loan")],-1)),o.hasEnoughBalance?L("",!0):(p(),w("div",G,[e("div",H,[r(a(D),{size:24,class:"text-red-400"}),t[6]||(t[6]=e("h3",{class:"text-lg font-bold text-white"},"Insufficient Balance",-1))]),e("p",J," You need at least KES "+n(o.applicationFee)+" for the application fee. Your current balance is KES "+n(u(o.userBalance))+". ",1),r(a(_),{href:"/wallet/deposit",class:"bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200 inline-flex items-center space-x-2"},{default:f(()=>[r(a(R),{size:16}),t[7]||(t[7]=e("span",null,"Deposit Funds",-1))]),_:1})])),e("div",Q,[e("div",X,[e("div",Z,[t[13]||(t[13]=e("h3",{class:"text-xl font-bold text-white mb-6"},"Loan Application Form",-1)),e("form",{onSubmit:B(A,["prevent"])},[e("div",ee,[e("label",te,[r(a(P),{size:16,class:"inline mr-2"}),t[8]||(t[8]=c(" Loan Amount (KES) "))]),e("div",se,[t[9]||(t[9]=e("span",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-purple-400"},"KES",-1)),h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.amount=l),type:"number",min:o.minAmount,max:o.maxAmount,required:"",disabled:!o.hasEnoughBalance,class:"w-full bg-black/30 border border-purple-500/30 text-white rounded-xl pl-16 pr-4 py-3 focus:outline-none focus:border-purple-400 disabled:opacity-50",placeholder:"Enter amount"},null,8,oe),[[k,s.amount]])]),e("div",le,[e("span",ae,"Min: KES "+n(u(o.minAmount)),1),e("span",ne,"Max: KES "+n(u(o.maxAmount)),1)])]),e("div",re,[e("label",ie,[r(a(I),{size:16,class:"inline mr-2"}),t[10]||(t[10]=c(" Loan Term (Months) "))]),e("div",de,[(p(),w(K,null,T(E,l=>e("button",{key:l,type:"button",onClick:y=>s.term_months=l,class:z([s.term_months===l?"bg-purple-600 text-white border-purple-500":"bg-black/30 text-purple-300 border-purple-500/30","border rounded-lg py-2 text-center transition-all duration-200"])},n(l)+" months ",11,ue)),64))])]),e("div",me,[e("label",pe,[r(a($),{size:16,class:"inline mr-2"}),t[11]||(t[11]=c(" Loan Purpose (Optional) "))]),h(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.purpose=l),disabled:!o.hasEnoughBalance,rows:"3",class:"w-full bg-black/30 border border-purple-500/30 text-white rounded-xl px-4 py-3 focus:outline-none focus:border-purple-400 disabled:opacity-50",placeholder:"What will you use the loan for?"},null,8,ce),[[k,s.purpose]])]),e("div",be,[e("div",xe,[h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.agreeTerms=l),type:"checkbox",id:"terms",disabled:!o.hasEnoughBalance,required:"",class:"mt-1"},null,8,fe),[[M,s.agreeTerms]]),e("label",he," I agree to the loan terms and conditions. I understand that a non-refundable application fee of KES "+n(o.applicationFee)+" will be deducted from my balance. ",1)])]),e("div",ge,[e("button",{type:"submit",disabled:!o.hasEnoughBalance||m.value,class:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 disabled:from-slate-600 disabled:to-slate-600 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center space-x-2"},[m.value?(p(),x(a(q),{key:0,class:"animate-spin",size:20})):(p(),x(a(U),{key:1,size:20})),e("span",null,n(m.value?"Processing...":"Submit Application"),1)],8,ye),r(a(_),{href:"/loans",class:"flex-1 border border-purple-500/30 text-purple-400 hover:bg-purple-500/20 py-3 px-6 rounded-lg text-center transition-all duration-200"},{default:f(()=>t[12]||(t[12]=[c(" Cancel ")])),_:1})])],32)])]),e("div",ve,[e("div",we,[t[20]||(t[20]=e("h3",{class:"text-lg font-bold text-white mb-4"},"Loan Summary",-1)),e("div",_e,[e("div",ke,[t[14]||(t[14]=e("span",{class:"text-sm text-blue-300"},"Loan Amount",-1)),e("span",Ee,"KES "+n(u(s.amount||0)),1)]),e("div",Se,[t[15]||(t[15]=e("span",{class:"text-sm text-blue-300"},"Term",-1)),e("span",Ae,n(s.term_months)+" months",1)]),e("div",Ce,[t[16]||(t[16]=e("span",{class:"text-sm text-blue-300"},"Interest Rate",-1)),e("span",Fe,n(o.interestRate)+"% p.a.",1)]),e("div",Le,[t[17]||(t[17]=e("span",{class:"text-sm text-blue-300"},"Application Fee",-1)),e("span",Be,"KES "+n(o.applicationFee),1)]),e("div",Ke,[e("div",Te,[t[18]||(t[18]=e("span",{class:"text-sm text-blue-300"},"Estimated Monthly Payment",-1)),e("span",ze,"KES "+n(u(g.value)),1)]),e("div",Me,[t[19]||(t[19]=e("span",{class:"text-sm text-blue-300"},"Total Repayable",-1)),e("span",Ne,"KES "+n(u(S.value)),1)])])])]),e("div",je,[t[25]||(t[25]=e("h3",{class:"text-lg font-bold text-white mb-4"},"Requirements",-1)),e("ul",Pe,[e("li",Ve,[r(a(b),{size:16,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[21]||(t[21]=e("span",null,"Valid account with sufficient balance for application fee",-1))]),e("li",De,[r(a(b),{size:16,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[22]||(t[22]=e("span",null,"No active or pending loans",-1))]),e("li",Re,[r(a(b),{size:16,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[23]||(t[23]=e("span",null,"Loan amount between KES 1,000 - 50,000",-1))]),e("li",Ie,[r(a(b),{size:16,class:"text-green-400 flex-shrink-0 mt-0.5"}),t[24]||(t[24]=e("span",null,"Term between 3 - 36 months",-1))])])])])])])])]),_:1}))}};export{tt as default};
